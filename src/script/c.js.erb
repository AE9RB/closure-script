<% 
# This template demonstrates how to get at the compiler log.
# You will see the log on the browser console any time the
# compiler is run and there is an error or warning.
# Use `--summary_detail_level 3` if you want to see a log
# on all successful compilations (no errors or warnings).
# If there's no log to display, a cachable file response is used.
# This is just an example to get you started. There are certainly
# more elegant ways to display a log and you could easily save
# it to the filesystem if you wanted to show it every time.

comp = goog.compile(%w{
  --summary_detail_level 3
  --ns googly.test
  --warning_level VERBOSE
  --js_output_file js.out
  --compilation_level ADVANCED_OPTIMIZATIONS    
})
if !comp.stderr or comp.stderr.empty?
  @response = comp.to_response
else -%>
<% err_str = comp.stderr.split("\n").last; if err_str.to_i > 0 -%>
try{console.error(<%= ('Closure Compiler: '+err_str).dump %>)}catch(err){}
<% end -%>
try{console.log(<%= comp.stderr.dump %>)}catch(err){}
<%= comp %>
<% end -%>